
Singleton Pattern - Thread-Safe in Java

Need only ONE instance of a class in a multi-threaded app? Here's the Double-Checked Locking Singleton!

ğŸ”‘ Why This Works?
1. Private constructor â†’ Can't do new DatabaseConnection()
2. volatile â†’ All threads see the instance immediately (prevents each thread from having its own cached copy)
3. First check â†’ Fast! No locking if instance exists (99% of calls after first creation)
4. synchronized â†’ Only one thread creates instance (like a door lock - one person at a time)
5. Second check â†’ Prevents duplicate creation (Thread A creates instance, Thread B waiting outside gets latest value when enters)

ğŸ¬ What Happens Without This?
Without volatile: Thread 1 creates instance, but Thread 2's CPU cache doesn't see it â†’ creates duplicate! âŒ
Without double-check: Every getInstance() call waits for lock even when instance exists â†’ slow performance! ğŸŒ

âš¡ Result:
âœ… Thread-safe
âœ… Single instance guaranteed
âœ… No memory waste

________________________________________________________________________________________________________

public class DatabaseConnection {

    private String connectionString;

    // Private constructor â€“ blocks external instantiation
    private DatabaseConnection() {
        this.connectionString = "jdbc:mysql://localhost:3306/mydb";
        System.out.println("ğŸ”Œ Database connected!");
    }

    // volatile = visible to all threads immediately
    private static volatile DatabaseConnection instance = null;

    // Double-checked locking = thread-safe + fast
    public static DatabaseConnection getInstance() {
        if (instance == null) { // First check (no lock)
            synchronized (DatabaseConnection.class) { // Lock only if needed
                if (instance == null) { // Second check (safe)
                    instance = new DatabaseConnection();
                }
            }
        }
        return instance;
    }

    public void executeQuery(String sql) {
        System.out.println("ğŸ“Š Executing: " + sql);
    }

    // Usage
    public static void main(String[] args) {
        DatabaseConnection db1 = DatabaseConnection.getInstance();
        DatabaseConnection db2 = DatabaseConnection.getInstance();

        System.out.println(db1 == db2); // true â€“ same instance âœ…
    }
}
This is a thread-safe Singleton using double-checked locking with volatile to prevent multiple object creation.
